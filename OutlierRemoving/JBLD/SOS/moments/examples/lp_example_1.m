% AUTHOR: Jose Lopez NEU 2014
% LICENSE:This code is licensed under the BSD License.
%
% This script implements Example 5.5 in Lasserre text, pg. 127. This is
% when I was checking to see if LP/moment formulations were possibly better
% than SDP/moment formulations...
%
clear;clc;
close all;
%%
cvx_clear
cvx_begin 
cvx_solver sedumi
%cvx_precision high


variables y0 y1 y2 y3 y4 y5 y6 y7 y8 y9 y10 y11 y12 y13 y14 y15
f0 = y2-y1;
minimize(f0)
subject to
y0==1

y1>=0
1-y1>=0

y2>=0
-y2+y1>=0
y2-2*y1+1>=0

y3>=0
-y3+y2>=0
y3-2*y2+y1>=0
-y3+3*y2-3*y1+1>=0

y4>=0
-y4+y3>=0
y4-2*y3+y2>=0
-y4+3*y3-3*y2+y1>=0
y4-4*y3+6*y2-4*y1+1>=0

y5>=0
-y5+y4>=0
y5-2*y4+y3>=0
-y5+3*y4-3*y3+y2>=0
y5-4*y4+6*y3-4*y2+y1>=0
-y5+5*y4-10*y3+10*y2-5*y1+1>=0

y6>=0
-y6+y5>=0
y6-2*y5+y4>=0
-y6+3*y5-3*y4+y3>=0
y6-4*y5+6*y4-4*y3+y2>=0
-y6+5*y5-10*y4+10*y3-5*y2+y1>=0
y6-6*y5+15*y4-20*y3+15*y2-6*y1+1>=0

y7>=0
-y7+y6>=0
y7-2*y6+y5>=0
-y7+3*y6-3*y5+y4>=0
y7-4*y6+6*y5-4*y4+y3>=0
-y7+5*y6-10*y5+10*y4-5*y3+y2>=0
y7-6*y6+15*y5-20*y4+15*y3-6*y2+y1>=0
-y7+7*y6-21*y5+35*y4-35*y3+21*y2-7*y1+1>=0

y8>=0
-y8+y7>=0
y8-2*y7+y6>=0
-y8+3*y7-3*y6+y5>=0
y8-4*y7+6*y6-4*y5+y4>=0
-y8+5*y7-10*y6+10*y5-5*y4+y3>=0
y8-6*y7+15*y6-20*y5+15*y4-6*y3+y2>=0
-y8+7*y7-21*y6+35*y5-35*y4+21*y3-7*y2+y1>=0
y8-8*y7+28*y6-56*y5+70*y4-56*y3+28*y2-8*y1+1>=0

y9>=0
-y9+y8>=0
y9-2*y8+y7>=0
-y9+3*y8-3*y7+y6>=0
y9-4*y8+6*y7-4*y6+y5>=0
-y9+5*y8-10*y7+10*y6-5*y5+y4>=0
y9-6*y8+15*y7-20*y6+15*y5-6*y4+y3>=0
-y9+7*y8-21*y7+35*y6-35*y5+21*y4-7*y3+y2>=0
y9-8*y8+28*y7-56*y6+70*y5-56*y4+28*y3-8*y2+y1>=0
-y9+9*y8-36*y7+84*y6-126*y5+126*y4-84*y3+36*y2-9*y1+1>=0

y10>=0
-y10+y9>=0
y10-2*y9+y8>=0
-y10+3*y9-3*y8+y7>=0
y10-4*y9+6*y8-4*y7+y6>=0
-y10+5*y9-10*y8+10*y7-5*y6+y5>=0
y10-6*y9+15*y8-20*y7+15*y6-6*y5+y4>=0
-y10+7*y9-21*y8+35*y7-35*y6+21*y5-7*y4+y3>=0
y10-8*y9+28*y8-56*y7+70*y6-56*y5+28*y4-8*y3+y2>=0
-y10+9*y9-36*y8+84*y7-126*y6+126*y5-84*y4+36*y3-9*y2+y1>=0
y10-10*y9+45*y8-120*y7+210*y6-252*y5+210*y4-120*y3+45*y2-10*y1+1>=0

y11>=0
-y11+y10>=0
y11-2*y10+y9>=0
-y11+3*y10-3*y9+y8>=0
y11-4*y10+6*y9-4*y8+y7>=0
-y11+5*y10-10*y9+10*y8-5*y7+y6>=0
y11-6*y10+15*y9-20*y8+15*y7-6*y6+y5>=0
-y11+7*y10-21*y9+35*y8-35*y7+21*y6-7*y5+y4>=0
y11-8*y10+28*y9-56*y8+70*y7-56*y6+28*y5-8*y4+y3>=0
-y11+9*y10-36*y9+84*y8-126*y7+126*y6-84*y5+36*y4-9*y3+y2>=0
y11-10*y10+45*y9-120*y8+210*y7-252*y6+210*y5-120*y4+45*y3-10*y2+y1>=0
-y11+11*y10-55*y9+165*y8-330*y7+462*y6-462*y5+330*y4-165*y3+55*y2-11*y1+1>=0

y12>=0
-y12+y11>=0
y12-2*y11+y10>=0
-y12+3*y11-3*y10+y9>=0
y12-4*y11+6*y10-4*y9+y8>=0
-y12+5*y11-10*y10+10*y9-5*y8+y7>=0
y12-6*y11+15*y10-20*y9+15*y8-6*y7+y6>=0
-y12+7*y11-21*y10+35*y9-35*y8+21*y7-7*y6+y5>=0
y12-8*y11+28*y10-56*y9+70*y8-56*y7+28*y6-8*y5+y4>=0
-y12+9*y11-36*y10+84*y9-126*y8+126*y7-84*y6+36*y5-9*y4+y3>=0
y12-10*y11+45*y10-120*y9+210*y8-252*y7+210*y6-120*y5+45*y4-10*y3+y2>=0
-y12+11*y11-55*y10+165*y9-330*y8+462*y7-462*y6+330*y5-165*y4+55*y3-11*y2+y1>=0
y12-12*y11+66*y10-220*y9+495*y8-792*y7+924*y6-792*y5+495*y4-220*y3+66*y2-12*y1+1>=0

y13>=0
-y13+y12>=0
y13-2*y12+y11>=0
-y13+3*y12-3*y11+y10>=0
y13-4*y12+6*y11-4*y10+y9>=0
-y13+5*y12-10*y11+10*y10-5*y9+y8>=0
y13-6*y12+15*y11-20*y10+15*y9-6*y8+y7>=0
-y13+7*y12-21*y11+35*y10-35*y9+21*y8-7*y7+y6>=0
y13-8*y12+28*y11-56*y10+70*y9-56*y8+28*y7-8*y6+y5>=0
-y13+9*y12-36*y11+84*y10-126*y9+126*y8-84*y7+36*y6-9*y5+y4>=0
y13-10*y12+45*y11-120*y10+210*y9-252*y8+210*y7-120*y6+45*y5-10*y4+y3>=0
-y13+11*y12-55*y11+165*y10-330*y9+462*y8-462*y7+330*y6-165*y5+55*y4-11*y3+y2>=0
y13-12*y12+66*y11-220*y10+495*y9-792*y8+924*y7-792*y6+495*y5-220*y4+66*y3-12*y2+y1>=0
-y13+13*y12-78*y11+286*y10-715*y9+1287*y8-1716*y7+1716*y6-1287*y5+715*y4-286*y3+78*y2-13*y1+1>=0

y14>=0
-y14+y13>=0
y14-2*y13+y12>=0
-y14+3*y13-3*y12+y11>=0
y14-4*y13+6*y12-4*y11+y10>=0
-y14+5*y13-10*y12+10*y11-5*y10+y9>=0
y14-6*y13+15*y12-20*y11+15*y10-6*y9+y8>=0
-y14+7*y13-21*y12+35*y11-35*y10+21*y9-7*y8+y7>=0
y14-8*y13+28*y12-56*y11+70*y10-56*y9+28*y8-8*y7+y6>=0
-y14+9*y13-36*y12+84*y11-126*y10+126*y9-84*y8+36*y7-9*y6+y5>=0
y14-10*y13+45*y12-120*y11+210*y10-252*y9+210*y8-120*y7+45*y6-10*y5+y4>=0
-y14+11*y13-55*y12+165*y11-330*y10+462*y9-462*y8+330*y7-165*y6+55*y5-11*y4+y3>=0
y14-12*y13+66*y12-220*y11+495*y10-792*y9+924*y8-792*y7+495*y6-220*y5+66*y4-12*y3+y2>=0
-y14+13*y13-78*y12+286*y11-715*y10+1287*y9-1716*y8+1716*y7-1287*y6+715*y5-286*y4+78*y3-13*y2+y1>=0
y14-14*y13+91*y12-364*y11+1001*y10-2002*y9+3003*y8-3432*y7+3003*y6-2002*y5+1001*y4-364*y3+91*y2-14*y1+1>=0

y15>=0
-y15+y14>=0
y15-2*y14+y13>=0
-y15+3*y14-3*y13+y12>=0
y15-4*y14+6*y13-4*y12+y11>=0
-y15+5*y14-10*y13+10*y12-5*y11+y10>=0
y15-6*y14+15*y13-20*y12+15*y11-6*y10+y9>=0
-y15+7*y14-21*y13+35*y12-35*y11+21*y10-7*y9+y8>=0
y15-8*y14+28*y13-56*y12+70*y11-56*y10+28*y9-8*y8+y7>=0
-y15+9*y14-36*y13+84*y12-126*y11+126*y10-84*y9+36*y8-9*y7+y6>=0
y15-10*y14+45*y13-120*y12+210*y11-252*y10+210*y9-120*y8+45*y7-10*y6+y5>=0
-y15+11*y14-55*y13+165*y12-330*y11+462*y10-462*y9+330*y8-165*y7+55*y6-11*y5+y4>=0
y15-12*y14+66*y13-220*y12+495*y11-792*y10+924*y9-792*y8+495*y7-220*y6+66*y5-12*y4+y3>=0
-y15+13*y14-78*y13+286*y12-715*y11+1287*y10-1716*y9+1716*y8-1287*y7+715*y6-286*y5+78*y4-13*y3+y2>=0
y15-14*y14+91*y13-364*y12+1001*y11-2002*y10+3003*y9-3432*y8+3003*y7-2002*y6+1001*y5-364*y4+91*y3-14*y2+y1>=0
-y15+15*y14-105*y13+455*y12-1365*y11+3003*y10-5005*y9+6435*y8-6435*y7+5005*y6-3003*y5+1365*y4-455*y3+105*y2-15*y1+1>=0

cvx_end
y1
y0
%  i   2    4    6    10     15
% Li -1/3 -1/3 -0.3 -0.27 -0.2695
%%
return
%%
basis_data = get_monomial_basis(15,2);
basis = double(basis_data.basis);
syms X real
g1 = X
g2 = (1-X)
n_mons = size(basis,1);
temp = [];
for k = 1:n_mons
    mon = basis(k,:);
    temp = [temp;
    expand(g1^mon(1)*g2^mon(2))];
end